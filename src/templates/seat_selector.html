<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seat Selection</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .seat {
            transition: all 0.3s ease;
        }
        .seat:hover:not(.blocked) {
            transform: scale(1.1);
            cursor: pointer;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-blue-950 to-slate-900 min-h-screen p-8">
    <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-white mb-2">Select Your Seat</h1>
            <p class="text-slate-400">Flight ABC123 | Economy Class</p>
        </div>

        <!-- Legend -->
        <div class="bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6 mb-8">
            <h3 class="text-white font-semibold mb-4 text-lg">Seat Legend</h3>
            <div class="flex flex-wrap gap-6 justify-center">
                <div class="flex items-center gap-2">
                    <div class="w-8 h-8 bg-blue-500 rounded-lg"></div>
                    <span class="text-slate-300 text-sm">Available</span>
                </div>
                <div class="flex items-center gap-2">
                    <div class="w-8 h-8 bg-green-500 rounded-lg"></div>
                    <span class="text-slate-300 text-sm">Selected</span>
                </div>
                <div class="flex items-center gap-2">
                    <div class="w-8 h-8 bg-slate-600 rounded-lg opacity-50"></div>
                    <span class="text-slate-300 text-sm">Blocked</span>
                </div>
            </div>
        </div>

        <!-- Airplane Cabin -->
        <div class="bg-white/5 backdrop-blur-xl border border-white/10 rounded-3xl p-8 shadow-2xl">
            <!-- Cockpit -->
            <div class="text-center mb-8">
                <div class="inline-block bg-gradient-to-b from-blue-600 to-blue-800 rounded-t-full px-16 py-4">
                    <i class="fas fa-plane text-white text-3xl"></i>
                </div>
            </div>

            <!-- Seat Grid -->
            <div class="space-y-3" id="seatGrid">
                <!-- Rows will be generated by JavaScript -->
            </div>

            <!-- Emergency Exit Indicator -->
            <div class="text-center my-6">
                <div class="inline-block bg-red-500/20 border border-red-500/50 rounded-lg px-6 py-2">
                    <span class="text-red-400 text-sm font-semibold">
                        <i class="fas fa-door-open mr-2"></i>EMERGENCY EXIT
                    </span>
                </div>
            </div>

            <!-- More rows after exit -->
            <div class="space-y-3" id="seatGridBack">
                <!-- More rows will be generated by JavaScript -->
            </div>
        </div>

        <!-- Selection Summary -->
        <div class="mt-8 bg-gradient-to-r from-green-600 to-blue-600 rounded-2xl p-6 shadow-2xl" id="summaryCard" style="display: none;">
            <div class="flex items-center justify-between flex-wrap gap-4">
                <div>
                    <h3 class="text-white font-bold text-xl mb-1">Seat Selected</h3>
                    <p class="text-white/80 text-lg">Seat Number: <span id="selectedSeatNumber" class="font-bold">-</span></p>
                </div>
                <button onclick="confirmSeat()" class="bg-white text-blue-600 px-6 py-3 rounded-xl font-semibold hover:bg-blue-50 transition-all hover:shadow-lg">
                    Confirm Selection
                    <i class="fas fa-arrow-right ml-2"></i>
                </button>
            </div>
        </div>

        <!-- No Selection Message -->
        <div class="mt-8 bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6 text-center" id="noSelectionCard">
            <p class="text-slate-400">Please select a seat to continue</p>
        </div>
    </div>

    <script>
        // Seat configuration
        const rows = 15;
        const seatsPerRow = 6; // 3-3 configuration (A B C - D E F)
        const aislePosition = 3; // Aisle after 3rd seat
        const blockedSeats = ['3B', '3E', '7C', '7D', '12A', '12F', '14B', '14E'];
        let selectedSeat = null;

        // Generate seat grid
        function generateSeats() {
            const seatGrid = document.getElementById('seatGrid');
            const seatGridBack = document.getElementById('seatGridBack');
            const letters = ['A', 'B', 'C', 'D', 'E', 'F'];

            for (let row = 1; row <= rows; row++) {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'flex justify-center items-center gap-3';

                // Row number (left)
                const rowNumLeft = document.createElement('div');
                rowNumLeft.className = 'text-slate-500 font-semibold w-8 text-center text-sm';
                rowNumLeft.textContent = row;
                rowDiv.appendChild(rowNumLeft);

                // Seats
                for (let seatIndex = 0; seatIndex < seatsPerRow; seatIndex++) {
                    if (seatIndex === aislePosition) {
                        // Aisle
                        const aisle = document.createElement('div');
                        aisle.className = 'w-12 text-center text-slate-600 text-xs';
                        aisle.innerHTML = '<i class="fas fa-arrow-down"></i>';
                        rowDiv.appendChild(aisle);
                    }

                    const seatLetter = letters[seatIndex];
                    const seatNumber = `${row}${seatLetter}`;
                    const isBlocked = blockedSeats.includes(seatNumber);

                    const seat = document.createElement('div');
                    seat.className = `seat w-10 h-10 rounded-lg flex items-center justify-center text-white text-xs font-semibold ${
                        isBlocked 
                            ? 'bg-slate-600 opacity-50 cursor-not-allowed' 
                            : 'bg-blue-500 hover:bg-blue-600'
                    }`;
                    seat.dataset.seat = seatNumber;
                    seat.innerHTML = isBlocked 
                        ? '<i class="fas fa-times"></i>' 
                        : seatLetter;

                    if (!isBlocked) {
                        seat.onclick = () => selectSeat(seatNumber, seat);
                    } else {
                        seat.classList.add('blocked');
                    }

                    rowDiv.appendChild(seat);
                }

                // Row number (right)
                const rowNumRight = document.createElement('div');
                rowNumRight.className = 'text-slate-500 font-semibold w-8 text-center text-sm';
                rowNumRight.textContent = row;
                rowDiv.appendChild(rowNumRight);

                // Distribute rows (first 8 before emergency exit)
                if (row <= 8) {
                    seatGrid.appendChild(rowDiv);
                } else {
                    seatGridBack.appendChild(rowDiv);
                }
            }
        }

        // Select seat
        function selectSeat(seatNumber, seatElement) {
            // Deselect previous seat
            if (selectedSeat) {
                const prevSeat = document.querySelector(`[data-seat="${selectedSeat}"]`);
                if (prevSeat && !prevSeat.classList.contains('blocked')) {
                    prevSeat.classList.remove('bg-green-500', 'hover:bg-green-600', 'ring-4', 'ring-green-300');
                    prevSeat.classList.add('bg-blue-500', 'hover:bg-blue-600');
                }
            }

            // Select new seat
            selectedSeat = seatNumber;
            seatElement.classList.remove('bg-blue-500', 'hover:bg-blue-600');
            seatElement.classList.add('bg-green-500', 'hover:bg-green-600', 'ring-4', 'ring-green-300');

            // Update summary
            document.getElementById('selectedSeatNumber').textContent = seatNumber;
            document.getElementById('summaryCard').style.display = 'block';
            document.getElementById('noSelectionCard').style.display = 'none';
        }

        // Confirm seat
        function confirmSeat() {
            if (selectedSeat) {
                alert(`Seat ${selectedSeat} confirmed! Proceeding to payment...`);
                // Here you would typically submit to the server
                window.location.href = "{{ url_for('dashboard') }}";
            }
        }

        // Initialize
        generateSeats();
    </script>
</body>
</html>
